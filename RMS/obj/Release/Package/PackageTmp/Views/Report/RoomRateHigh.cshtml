@model List<RMS.Models.Room>
@{
    decimal __comisionh = new decimal();
    decimal __factura = new decimal();
    decimal __margenrm = new decimal();
    decimal __gadmon = new decimal();
    decimal __facturab = new decimal();
    decimal __agente = new decimal();
    decimal __venta = new decimal();
    decimal __margen = new decimal();
    decimal __pmargen = new decimal();
    bool ShowExcel = ViewBag.Export ?? false;
}
<h1>
    Tarifas Temporada Alta: @Model.First().Hotel.Name</h1>
<h2>
    2 Noches
</h2>
<table border="0" cellpadding="0" cellspacing="0" class="table">
    <tr>
        <th>
            Habitaci&oacute;n
        </th>
        <th>
            Tarifa Rack PPN Hotel
        </th>
        <th>
            Comision Hotel
        </th>
        <th>
            Tarifa Neta PPN
        </th>
        <th>
            Margen Reg M
        </th>
        <th>
            Factura
        </th>
        <th>
            + G. Admon
        </th>
        <th>
            Factura Bruta
        </th>
        <th>
            - Agente
        </th>
        <th>
            Venta Neta
        </th>
        <th>
            Margen
        </th>
        <th>
            Margen %
        </th>
        <th>
            Diferencia Vs Hotel
        </th>
    </tr>
    @foreach (var __item in Model)
    {

        __comisionh = __item.HighSeasonRack - __item.HighSeasonPrice;
        __comisionh = __comisionh / __item.HighSeasonRack * 100;
        __factura = __item.HighSeasonRack - (__item.HighSeasonRack * (__item.Discount1.Value / 100));
        __margenrm = ((__factura - __item.HighSeasonPrice) / __factura) * 100;
        __gadmon = __factura * (__item.PercentAdmin / 100);
        __facturab = __factura + __gadmon;
        __agente = __factura * (__item.PercentAgent / 100);
        __venta = __facturab - __agente;
        __margen = __venta - __item.HighSeasonPrice;
        __pmargen = (__margen / __item.HighSeasonPrice) * 100;

        <tr>
            <td>
                @__item.Name
            </td>
            <td>@Math.Round(__item.HighSeasonRack, 2)
            </td>
            <td>
                @Math.Round(__comisionh, 2) %
            </td>
            <td>@Math.Round(__item.HighSeasonPrice, 2)
            </td>
            <td>
                @Math.Round(__margenrm, 2) %
            </td>
            <td>@Math.Round(__factura, 2)
            </td>
            <td>
                @Math.Round(__gadmon, 2)
            </td>
            <td>
                @Math.Round(__facturab, 2)
            </td>
            <td>@Math.Round(__agente, 2)
            </td>
            <td>@Math.Round(__venta, 2)
            </td>
            <td>@Math.Round(__margen, 2)
            </td>
            <td>@Math.Round(__pmargen, 2)
            </td>
            <td>@Math.Round(__item.Discount1.Value, 2)
            </td>
        </tr>
    }
</table>
<h2>
    4 Noches
</h2>
<table border="0" cellpadding="0" cellspacing="0" class="table">
    <tr>
        <th>
            Habitaci&oacute;n
        </th>
        <th>
            Tarifa Rack PPN Hotel
        </th>
        <th>
            Comision Hotel
        </th>
        <th>
            Tarifa Neta PPN
        </th>
        <th>
            Margen Reg M
        </th>
        <th>
            Factura
        </th>
        <th>
            + G. Admon
        </th>
        <th>
            Factura Bruta
        </th>
        <th>
            - Agente
        </th>
        <th>
            Venta Neta
        </th>
        <th>
            Margen
        </th>
        <th>
            Margen %
        </th>
        <th>
            Diferencia Vs Hotel
        </th>
    </tr>
    @foreach (var __item in Model)
    {

        __comisionh = __item.HighSeasonRack - __item.HighSeasonPrice;
        __comisionh = __comisionh / __item.HighSeasonRack * 100;
        __factura = __item.HighSeasonRack - (__item.HighSeasonRack * (__item.Discount2.Value / 100));
        __margenrm = ((__factura - __item.HighSeasonPrice) / __factura) * 100;
        __gadmon = __factura * (__item.PercentAdmin / 100);
        __facturab = __factura + __gadmon;
        __agente = __factura * (__item.PercentAgent / 100);
        __venta = __facturab - __agente;
        __margen = __venta - __item.HighSeasonPrice;
        __pmargen = (__margen / __item.HighSeasonPrice) * 100;

        <tr>
            <td>
                @__item.Name
            </td>
            <td>@Math.Round(__item.HighSeasonRack, 2)
            </td>
            <td>
                @Math.Round(__comisionh, 2) %
            </td>
            <td>@Math.Round(__item.HighSeasonPrice, 2)
            </td>
            <td>
                @Math.Round(__margenrm, 2) %
            </td>
            <td>@Math.Round(__factura, 2)
            </td>
            <td>
                @Math.Round(__gadmon, 2)
            </td>
            <td>
                @Math.Round(__facturab, 2)
            </td>
            <td>@Math.Round(__agente, 2)
            </td>
            <td>@Math.Round(__venta, 2)
            </td>
            <td>@Math.Round(__margen, 2)
            </td>
            <td>@Math.Round(__pmargen, 2)
            </td>
            <td>@Math.Round(__item.Discount2.Value, 2)
            </td>
        </tr>
    }
</table>
<h2>
    7 Noches
</h2>
<table border="0" cellpadding="0" cellspacing="0" class="table">
    <tr>
        <th>
            Habitaci&oacute;n
        </th>
        <th>
            Tarifa Rack PPN Hotel
        </th>
        <th>
            Comision Hotel
        </th>
        <th>
            Tarifa Neta PPN
        </th>
        <th>
            Margen Reg M
        </th>
        <th>
            Factura
        </th>
        <th>
            + G. Admon
        </th>
        <th>
            Factura Bruta
        </th>
        <th>
            - Agente
        </th>
        <th>
            Venta Neta
        </th>
        <th>
            Margen
        </th>
        <th>
            Margen %
        </th>
        <th>
            Diferencia Vs Hotel
        </th>
    </tr>
    @foreach (var __item in Model)
    {

        __comisionh = __item.HighSeasonRack - __item.HighSeasonPrice;
        __comisionh = __comisionh / __item.HighSeasonRack * 100;
        __factura = __item.HighSeasonRack - (__item.HighSeasonRack * (__item.Discount3.Value / 100));
        __margenrm = ((__factura - __item.HighSeasonPrice) / __factura) * 100;
        __gadmon = __factura * (__item.PercentAdmin / 100);
        __facturab = __factura + __gadmon;
        __agente = __factura * (__item.PercentAgent / 100);
        __venta = __facturab - __agente;
        __margen = __venta - __item.HighSeasonPrice;
        __pmargen = (__margen / __item.HighSeasonPrice) * 100;

        <tr>
            <td>
                @__item.Name
            </td>
            <td>@Math.Round(__item.HighSeasonRack, 2)
            </td>
            <td>
                @Math.Round(__comisionh, 2) %
            </td>
            <td>@Math.Round(__item.HighSeasonPrice, 2)
            </td>
            <td>
                @Math.Round(__margenrm, 2) %
            </td>
            <td>@Math.Round(__factura, 2)
            </td>
            <td>
                @Math.Round(__gadmon, 2)
            </td>
            <td>
                @Math.Round(__facturab, 2)
            </td>
            <td>@Math.Round(__agente, 2)
            </td>
            <td>@Math.Round(__venta, 2)
            </td>
            <td>@Math.Round(__margen, 2)
            </td>
            <td>@Math.Round(__pmargen, 2)
            </td>
            <td>@Math.Round(__item.Discount3.Value, 2)
            </td>
        </tr>
    }
</table>
<br />
@if (ShowExcel)
{
    <br />
    <a href="@Url.Action("PrintableRoom", new { temporada = 2, hotel = Model.First().IdHotel })">
        Exportar a Excel</a> 
}