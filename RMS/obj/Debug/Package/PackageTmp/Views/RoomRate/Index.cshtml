@model IEnumerable<RMS.Models.RoomOcupation>
@{
    ViewBag.Title = "Tarifas";
    RMS.Models.Room __room = ViewBag.Room;
}
<h2>
    Tarifas para la Habitación: @__room.Name<br />
    @__room.Hotel.Name
</h2>
<table border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td>
            @Html.ActionLink("Crear Nueva", "Create", new { Id = __room.Id })
        </td>
        <td>
            &nbsp;&nbsp;&nbsp;
            @Html.ActionLink("Variables", "Batch", new { Id = __room.Id }, new { @class = "popup" })
        </td>
    </tr>
</table>
<br />
<br />
<table id="list" cellpadding="0" cellspacing="0">
</table>
<div id="pager">
</div>
<p>
    @Html.ActionLink("Volver a Habitaciones", "Index", "Room", new { Id = __room.IdHotel }, null)</p>
<script type="text/javascript">
    $(".popup").colorbox({ iframe: true, width: 400, height: 450, onClosed: function () { location.reload(true); } });
    jQuery(document).ready(function () {
        jQuery("#list").jqGrid({
            url: '@Url.Action("GetDataFare", new { Id = __room.Id })',
            datatype: 'json',
            mtype: 'GET',
            colNames: ['Nombre', 'Cap.', 'Tarifa Rack', 'Tarifa Neta', 'Inicia', 'Termina', '% Desc 2N', '% Desc 4N', '% Desc 7N', '% Agente', '% Admon', 'Activo', 'Date'],
            colModel: [
            { name: 'Name', index: 'Name', width: 40, align: 'left' },
            { name: 'Capacity', index: 'Capacity', width: 15, align: 'center' },
            { name: 'PriceRack', index: 'PriceRack', width: 40, align: 'center' },
            { name: 'Price', index: 'Price', width: 40, align: 'center' },
            { name: 'DateStart', index: 'DateStart', width: 40, align: 'center' },
            { name: 'DateEnd', index: 'DateEnd', width: 40, align: 'center' },
            { name: 'Discount1', index: 'Discount1', width: 35, align: 'center' },
            { name: 'Discount2', index: 'Discount2', width: 35, align: 'center' },
            { name: 'Discount3', index: 'Discount3', width: 35, align: 'center' },
            { name: 'PercentAgent', index: 'PercentAgent', width: 40, align: 'center' },
            { name: 'PercentAdmin', PercentAdmin: 'Room', width: 40, align: 'center' },
            { name: 'Active', index: 'Active', width: 40, align: 'center', formatter: 'checkbox' },
            { name: 'Date', index: 'Date', width: 40, align: 'center'}],
            pager: jQuery('#pager'),
            sortname: 'Capacity',
            width: '900',
            height: 'auto',
            rowNum: 10,
            rowList: [5, 10, 20, 50],
            sortorder: "desc",
            viewrecords: true,
            imgpath: '/content/themes/regional/images',
            grouping: true,
            groupingView: {
                groupField: ['Date'],
                groupDataSorted: true,
                groupColumnShow: false,
                groupOrder: 'asc',
                groupText: ['<b style="font-size: 10pt">{0} - {1} Item(s)</b>']
            },
            caption: 'Tarifas',
            onSelectRow: function (id) {
                window.top.location = '@Url.Action("Edit")/' + id;
            }

        });
        //        jQuery("#list").jqGrid('navGrid','#pager',{edit:false,add:false,del:false});
    });
</script>
