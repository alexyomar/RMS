@model IEnumerable<RMS.Models.Reservation>
@{
    ViewBag.Title = "Index";
}
<h2>
    Reservaciones</h2>
<p>
    @Html.ActionLink("Crear Nueva", "Create")
</p>
<table class="table">
    <tr>
        <th>
            ID
        </th>
        <th>
            Cliente
        </th>
        <th>
            Fecha
        </th>
        <th>
            Tipo
        </th>
        <th>
            Precio
        </th>
        <th>
            Margen +
        </th>
        <th>
            Información
        </th>
        <th>
            Observaciones
        </th>
        <th>
        </th>
    </tr>
    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Id)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Customer.Name)&nbsp;@Html.DisplayFor(modelItem => item.Customer.LastName)
            </td>
            <td>
                R: @Html.Label(item.ReservationDate.ToShortDateString())<br />
                L: @Html.Label(item.Arrival.ToShortDateString())<br />
                S: @Html.Label(item.Departure.ToShortDateString())
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ReservationStatus.Name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Price)
            </td>
            <td>
                @{
        decimal __factura = item.Price;
        decimal __vendedor = item.PercentAgent / 100;
        decimal __margen = item.PriceRack;
        __vendedor = __factura * __vendedor;
        __factura = __factura - __vendedor;
        __margen = __factura - __margen;
        decimal __porcentaje = __margen / item.PriceRack;
        __porcentaje = Math.Round(__porcentaje * 100, 2);
                }
                @__porcentaje %
            </td>
            <td>
                Adultos: @Html.DisplayFor(modelItem => item.Adults)<br />
                Niños: @Html.DisplayFor(modelItem => item.Childrens)
            </td>
            <td>
                @if (item.Discount != 0)
                { 
                    <span>Desc: @item.Discount %</span><br />
                }
                @if (item.PercentAdmin != 0)
                { 
                    <span>Admon: @item.PercentAdmin % </span>
                    <br />
                }
                @if (item.PercentAgent != 0)
                { 
                    <span>Agente: @item.PercentAgent % </span>
                    <br />
                }
            </td>
            <td>
                @*@Html.ActionLink("Edit", "Edit", new { id = item.Id }) |*@
                @Html.ActionLink("Detalles", "PrintableVersion", new { id = item.Id }, new { target = "_blank" })
                |
                @Html.ActionLink("Descargar PDF", "PrintPDF", new { id = item.Id })
                @*@Html.ActionLink("Delete", "Delete", new { id = item.Id })*@
            </td>
        </tr>
    }
</table>
